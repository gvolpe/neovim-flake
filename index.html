<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Neovim Flake by Gabriel Volpe</title><link rel="stylesheet" type="text/css" href="style.css" /><link rel="stylesheet" type="text/css" href="overrides.css" /><link rel="stylesheet" type="text/css" href="night-owl.css" /><script src="highlight.pack.js" type="text/javascript"></script><script src="highlight.load.js" type="text/javascript"></script><meta name="generator" content="DocBook XSL Stylesheets V1.79.2" /><link rel="home" href="index.html" title="Neovim Flake by Gabriel Volpe" /><link rel="next" href="options.html" title="Appendix A. Configuration options" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Neovim Flake by Gabriel Volpe</th></tr><tr><td width="20%" align="left"> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="options.html">Next</a></td></tr></table><hr /></div><div class="book"><div class="titlepage"><div><div><h1 class="title"><a id="book-neovim-flake-manual"></a>Neovim Flake by Gabriel Volpe</h1></div></div><hr /></div><div class="toc"><dl class="toc"><dt><span class="chapter"><a href="index.html#ch-try-it-out">1. Try it out</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#_scala">1.1. Scala</a></span></dt><dt><span class="section"><a href="index.html#_haskell">1.2. Haskell</a></span></dt></dl></dd><dt><span class="chapter"><a href="index.html#ch-hm-module">2. Home Manager</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#_packages">2.1. Packages</a></span></dt><dt><span class="section"><a href="index.html#_configuration_files">2.2. Configuration files</a></span></dt></dl></dd><dt><span class="appendix"><a href="options.html">A. Configuration options</a></span></dt></dl></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="ch-try-it-out"></a>Chapter 1. Try it out</h1></div></div></div><pre class="programlisting console">$ cachix use gvolpe-nixos # Optional: it'll save you CPU resources and time
$ nix run github:gvolpe/neovim-flake</pre><p>By default, LSP support is enabled for Scala, Dhall, Elm, Nix, and Smithy.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_scala"></a>1.1. Scala</h2></div></div></div><p>Those only interested in Scala LSP support can try the more lightweight versions.</p><pre class="programlisting console">$ nix run github:gvolpe/neovim-flake#scala
$ nix run github:gvolpe/neovim-flake#scala-rose-pine
$ nix run github:gvolpe/neovim-flake#scala-tokyo-night</pre><p>The default theme is <code class="literal">onedark</code> with transparency enabled, but there are other flavors.</p><p>You may also try Neovim nightly version.</p><pre class="programlisting console">$ nix run github:gvolpe/neovim-flake#scala-nightly</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_haskell"></a>1.2. Haskell</h2></div></div></div><p>Those only interested in Haskell LSP support can try the exclusive version.</p><pre class="programlisting console">$ nix run github:gvolpe/neovim-flake#haskell</pre><p>Haskell LSP requires a lot of packages, so expect a heavy build or download if you are leveraging the binary cache. For this reason, Haskell is disabled in the default IDE configuration.</p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="ch-hm-module"></a>Chapter 2. Home Manager</h1></div></div></div><p>The Home Manager module allows us to customize the different <code class="literal">vim</code> options. To use it, we first add the input flake.</p><pre class="programlisting nix">{
  neovim-flake = {
    url = github:gvolpe/neovim-flake;
    inputs.nixpkgs.follows = "nixpkgs";
  };
}</pre><p>Followed by importing the HM module.</p><pre class="programlisting nix">{
  imports = [ neovim-flake.nixosModules.hm ];
}</pre><p>Then we should be able to use the given module. E.g.</p><pre class="programlisting nix">{
  programs.neovim-ide = {
    enable = true;
    settings = {
      vim.viAlias = false;
      vim.vimAlias = true;
      vim.lsp = {
        enable = true;
      };
    };
  };
}</pre><p>Besides the classic <a class="xref" href="options.html" title="Appendix A. Configuration options">Appendix A, <em>Configuration options</em></a>, you can also use the <a class="link" href="https://gvolpe.com/neovim-flake/search.html" target="_top">searchable module options</a>.</p><p>For the Scala module, the <code class="literal">metals</code> binary can be easily overridden with the provided builder. E.g.</p><pre class="programlisting nix">{
  vim.lsp = {
    enable = true;
    scala = {
      enable = true;
      metals = pkgs.metalsBuilder {
        version = "0.11.8+76-22425a8b-SNAPSHOT";
        outputHash = "[Insert hash (try nix build .#)]";
      };
      type = "nvim-metals"; # or nvim-lspconfig
    };
  };
}</pre><p>We can also choose to use the minimal configuration via <code class="literal">nvim-lspconfig</code> or use the more featureful <a class="link" href="https://github.com/scalameta/nvim-metals" target="_top">nvim-metals</a> (default and recommended).</p><div class="note"><h3 class="title">Note</h3><p>To use <code class="literal">metalsBuilder</code>, you need to add the following overlay.</p></div><pre class="programlisting nix">{
  pkgs = import nixpkgs {
    inherit system;
    overlays = [ neovim-flake.overlays.default ];
  };
}</pre><p>You can have a look at my <a class="link" href="https://github.com/gvolpe/nix-config" target="_top">nix-config</a> for a full example.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_packages"></a>2.1. Packages</h2></div></div></div><p>Besides the full-fledged IDE and HM modules, there are a few packages exposed that may prove useful to your use case.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<code class="literal">ts-scala</code>: tree-sitter-scala version that tracks the latest master changes.
</li><li class="listitem">
<code class="literal">nvim-treesitter</code>: latest nvim-treesitter ensuring compatibility with <code class="literal">tree-sitter-scala</code>.
</li></ul></div><p>If you have your own NeoVim configuration, you can still leverage <code class="literal">nvim-treesitter</code> by first adding the overlay, and then using the following package.</p><pre class="programlisting nix">{
  programs.neovim = {
    enable = true;
    plugins = [
      pkgs.neovimPlugins.nvim-treesitter
    ];
  };
}</pre><p>Or more directly without the overlay.</p><pre class="programlisting nix">{
  programs.neovim = {
    enable = true;
    plugins = [
      inputs.neovim-flake.packages.${system}.nvim-treesitter
    ];
  };
}</pre><p>You can see all the enabled grammars for this package <a class="link" href="https://github.com/gvolpe/neovim-flake/blob/main/lib/buildPlugin.nix#L15" target="_top">here</a>.</p><p>The <code class="literal">ts-scala</code> package only builds <code class="literal">tree-sitter-scala</code> from <code class="literal">master</code>, but it wouldn’t be as useful for your own configuration because <code class="literal">nvim-treesitter</code> requires a few tweaks.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_configuration_files"></a>2.2. Configuration files</h2></div></div></div><p>Furthermore, the generated <code class="literal">neovimRC</code> and <code class="literal">luaRC</code> files for every flavor of Neovim exposed by this flake are also available as derivations for better visibility.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<code class="literal">ide-lua-rc</code>
</li><li class="listitem">
<code class="literal">ide-neovim-rc</code>
</li><li class="listitem">
<code class="literal">haskell-lua-rc</code>
</li><li class="listitem">
<code class="literal">haskell-neovim-rc</code>
</li><li class="listitem">
<code class="literal">scala-lua-rc</code>
</li><li class="listitem">
<code class="literal">scala-neovim-rc</code>
</li></ul></div><p>These could also be useful to debug when plugins don’t work as expected.</p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="options.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top"> </td><td width="20%" align="center"> </td><td width="40%" align="right" valign="top"> Appendix A. Configuration options</td></tr></table></div></body></html>